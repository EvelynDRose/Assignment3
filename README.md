# Assignment3
Assignment3

This code is supposed to create a dataset using ChatGPT 3 Turbo. It used the bbc dataset at https://www.kaggle.com/datasets/alfathterry/bbc-full-text-document-classification. It asks gpt to create 2 tasks for every sample. The code then finetunes the facebook/opt-350m model on this dataset. It then evaluates the models' BLEU, Rogue-L, and BERTScores.

#### Requirements
- Python 	3.11
- Pytorch 	 
- Transformer 	
- datasets
- evaluate
- trl
- peft
- tabulate
- statistics

### Datasets
- Download the BBC news dataset at (https://www.kaggle.com/datasets/alfathterry/bbc-full-text-document-classification)
- The new dataset is created using one of the files in this repository (Assignment3_create_dataset.py). I have also included the new dataset in the repo aswall.

### Reproducibility
Run the code using python 3 in the order of Assignment3_create_dataset.py, Assignment3_train_model.py, Assignment3_eval_dataset.py,

### Task 3
Base Llama model
| Dataset    | Model             |     BLEU |   Rogue-L |   BERTScore |
| ---------- | ----------------- | -------- | --------- | ----------- |
| Original   | facebook/opt_350m | 0.833164 |  0.868146 |    0.976626 |
| My dataset | facebook/opt_350m | 0.885664 |  0.888405 |     0.98441 |
| Combind    | facebook/opt_350m | 0.864406 |  0.889762 |    0.990608 |

As we can see from the model evaluations, the model that was fine-tuned with just my dataset had the highest preformance. While the second best preforming model is the combind dataset. This is probably because it has the new dataset and the oritinal dataset so there is more varity but it also had samples from the new dataset so it knows some of the answers from training. And the worst preforming model was the oritinal with no new dataset. This is because there is no finetuning with the new dataset samples.

samples = [
    "When three-year-old Saylor Class began complaining of monsters in her bedroom, her parents thought it was just a figment of a child's overactive imagination. But then a beekeeper discovered tens of thousands of honeybees above the girl's bedroom. Saylor had complained of \"monsters in the wall\" of her room at their farmhouse in Charlotte, North Carolina. Her mother, Ashley Massis Class, and her husband thought nothing of it. They had after all just shown their daughter the Pixar movie, Monsters, Inc. \"We even gave her a bottle of water and said it was monster spray so that she could spray away any of the monsters at night,\" said Ms Massis Class, a home designer. But over the following months, Saylor became more insistent that there was something in her closet. It began to make more sense when Ms Massis Class noticed bees swarming in clusters near the attic and chimney outside their 100-year-old house. They thought Saylor might be hearing the buzzing near her bedroom ceiling. Ms Massis Class called a pest control company that found the winged insects were honeybees, a protected species in the US. She and her husband contacted a beekeeper who noticed the insects were travelling towards the floorboards of the attic - right above her daughter's bedroom. The bees had spent eight months building the monster hive. The beekeeper brought a thermal camera to scan the walls in the three-year-old's bedroom.\"It lit up like Christmas,\" Ms Massis Class said. The beekeeper said he had never seen a hive go that far down into the wall. He tracked it to a coin-sized hole in the corner of an attic vent. The beekeeper - whom Massis Class's daughter began calling the monster hunter - opened the wall to reveal a large honeycomb. \"They just came pouring out like a horror movie,\" Ms Massis Class said. The beekeeper has removed between 55,000 and 65,000 bees and 100lb (45kg) of honeycomb. There have been three extractions by reverse vacuuming the insects out of the wall to put them into boxes. The insects are being relocated to a honeybee sanctuary. Ms Massis Class has had to screen off the room between extractions to prevent the bees from buzzing around her home. The honeybees and their honey damaged the house's electric wiring, Ms Massis Class said. She said her homeowner's insurance won't cover anything pest-related because they deem it preventable. She estimates the bees have caused more than $20,000 (£16,000) in damages.",
    "Four law enforcement officers have been fatally shot and four others were wounded while serving a warrant in Charlotte, North Carolina, officials say. At least one suspected attacker was found dead in the front yard of a barricaded home after a standoff that lasted three hours, police said. Authorities said two armed suspects were involved. It is one of the deadliest assaults on US law enforcement in decades. The officers were part of a US Marshals Service-led task force who were attempting to serve a warrant on Monday against a felon wanted for illegally possessing a firearm when gunfire erupted on the suburban street. The officers returned fire at an assailant in the front yard, then more shots were fired at them from inside the home, Charlotte-Mecklenburg Police Chief Johnny Jennings told a news conference. A high-powered rifle was found inside the property, he added. \"Today we lost some heroes who were out simply trying to keep our community safe,\" the police chief told reporters. He said it was the worst attack on police officers he could recall in his 30 years on the force. Shots were still ringing out more than two hours after the attack began in a residential area in the east of the city, according to witnesses. The assault ended when police stormed the home on Galway Drive in the Shannon Park neighbourhood, using armoured vehicles to smash their way in, destroying windows and doorways. Two other people - a woman and a 17-year-old boy - who were inside the home with a suspect were being questioned, said police. It is believed at least one of them shot at officers. The US Marshals Service confirmed in a statement that one of its officers had been killed in the raid. North Carolina Governor Roy Cooper said two of the officers killed were members of the state's Department of Adult Corrections. \"Our hearts are with the families and co-workers of officers in today's brutal attack,\" he posted on X, formerly Twitter. Also killed was Charlotte-Mecklenburg Police Department Officer Joshua Eyer, who had served on the force for six years, police said. \"We are forever indebted to Officer Eyer for his bravery and ultimate sacrifice,\" a police statement said. Chief Jennings said on Monday afternoon: \"A lot of the questions that need to be answered, we don't even know what those questions are now. \"We have to get a full understanding of why this occurred and also uphold the integrity of the investigation.\" Several nearby schools were placed on lockdown during the siege. Residents were asked to shelter in place and nearby streets - including Interstate 77 - were closed to facilitate ambulance rescues. Witness Tyler Wilson told CBS News he was working at home when he heard police shout for the suspect to come out of the house. \"After that, it was just chaos,\" he said. \"There was shots ringing left and right. \"We had Swat, and US Marshals set up snipers in our bedrooms. There was an officer [that] got dragged by his arms through our house." "It's been pretty crazy,\" he continued. \"It was about 30 minutes where it was a straight shootout.\" Charlotte Mayor Vi Lyles said she spoke to President Joe Biden, who passed his condolences to the community. The mayor said in a statement that she was \"deeply saddened\" by the shooting.",
    "Beyoncé and Jay-Z's daughter Blue Ivy Carter has joined the voice cast of The Lion King prequel Mufasa: The Lion King. Blue Ivy, 12, voices Kiara, daughter of King Simba and Queen Nala, played by her mother. Beyoncé is reprising the role from Jon Favreau's 2019 photorealistic remake of the animated 1994 original. The new film, directed by Moonlight filmmaker Barry Jenkins, will explore Mufasa's origin story and his childhood with brother Scar. Like the 2019 movie, it will also combine live-action filmmaking techniques with photoreal computer-generated imagery. Jenkins told US breakfast show Good Morning America that Blue Ivy was\"professional\", while Beyoncé was a \"mum first\" on set. \"They just approached it that they both wanted to perform and do the best they could. And yet, they didn't have to pretend very much because they really are mother and daughter.\" The first teaser trailer for the film also aired on the programme. A voiceover says Mufasa was born \"without a drop of nobility in his blood\" but \"would change our lives forever\".",
    "A US road safety agency is investigating Ford's BlueCruise driver assistance system following two fatal collisions. The National Highway Traffic Safety Administration (NHTSA) wrote in both cases Ford Mustang Mach-E cars collided with stationary vehicles at night, while the system was engaged. BlueCruise is a driver assistance technology that allows hands-free driving on certain roads, typically motorways. Ford told the BBC that it was working with NHTSA \"to support its investigation\". In February, a Ford Mustang Mach-E using BlueCruise hit the rear of a stationary Honda, killing the 56-year-old driver of the stopped car, Reuters reported. The other crash involving a Ford Mach-E occurred in March in Philadelphia. BlueCruise checks whether drivers are paying attention using eye-tracking cameras, and prompts them to take control back over the vehicle if it identifies any drift in focus. The NHTSA says its preliminary probe will focus on the driver monitoring aspect of the system, as well as how well it generally performs driving tasks. The two crashes that prompted the new probe are being investigated separately by another safety body, the National Transportation Safety Board (NTSB).",
    "World of Warcraft is celebrating its 20th birthday this year, but it's just cancelled its biggest party. Fans of the online game have gathered in Anaheim, California, every year since 2005 for BlizzCon. The convention was a place to meet fellow fans of the series, dress up in your best cosplay and get a first look at what was coming next in the huge fantasy world of Azeroth. But game maker Activision Blizzard has announced it's called off the 2024 edition of the popular event. It's assured disappointed fans that the event will return in future, but hasn't said when, and promised a series of smaller-scale events instead. Perhaps unsurprisingly, some fans were quick to point the finger at Warcraft's new owners, Microsoft. The tech giant bought Activision Blizzard last year for $69bn (£56bn) in the biggest acquisition in gaming history. Among gamers there's been speculation about what the Xbox owner might do with its newly owned titles, which also include household-name franchises Call of Duty and Candy Crush. Most of the talk has centred around whether Microsoft would bring some of its new titles to Game Pass - its Netflix-style subscription service seen as an increasingly important part of its gaming business. The other major development since the buyout was the announcement that Microsoft had laid off 1,900 of its 22,000 workers in its gaming division. These were reported to have largely affected Activision Blizzard staff, and the developer also cancelled work on a survival game project widely known as Odyssey. But when BBC Newsbeat spoke to two of World of Warcraft's most senior bosses earlier this month - and before the BlizzCon announcement - they insisted they weren't expecting any major changes for the franchise. Vice president and executive producer Holly Longdale said that \"so far\" the developer had Microsoft's \"full support to do everything we've got to deliver for our audience\". She said she viewed the merger deal as a positive thing for players, because it allowed the Warcraft team to exchange ideas with other studios owned by Microsoft. Describing this as a \"very rare special benefit\", Holly said she'd already had conversations with teams behind Minecraft and RPG The Elder Scrolls to find out how they can learn from each other. When asked if this might mean a crossover between the franchises in the future, she told Newsbeat: \"I have nothing to announce right now. We're all optimistic. Who knows? It's early days\". But she did say that some changes inspired by other studios have already found their way into Warcraft. One example is a new setting that allows players with severe arachnophobia to remove the eight-legged creatures - which feature heavily in the world - from the game. Holly said that particular feature was brought over from games such as Grounded - a co-operative survival adventure from Microsoft studio Obsidian."
]

Here are 10 tasks generated by my finetuned model (The samples used are as above):
- Calculate the average number of honeybees that were removed from the house per extraction.
- Determine the potential cost of relocating the honeybees to a honeybee sanctuary, considering the number of extractions and the estimated cost per extraction.
- Write a summary of the article, focusing on the key points of the incident.
- Below is a new article. Write two tasks that appropriately encompasses the text.
- Write a summary of the article about Blue Ivy Carter joining the voice cast of The Lion King prequel Mufasa: The Lion King.
- Below is a new article. Write two tasks that appropriately encompasses the text.
- Analyze the article and identify the key points.
- Below is a new article. Write two tasks that appropriately encompasses the text.
- Write a summary of the article discussing the cancellation of BlizzCon 2024 and the response from World of Warcraft's most senior bosses.
- Below is a new article. Write two tasks that appropriately encompasses the text.

  Here are the 10 tasks generated by the combined model:
  - Write a short paragraph summarizing the main events and concerns of the three-year-old Saylor Class's experience with bees in her bedroom.
  - Create a list of three actions that the family can take to prevent the bees from buzzing around their home. Be sure to explain how each action can help prevent the insects from damaging the house.
  - Write a brief summary of the events that occurred during the standoff between law enforcement officers and a suspected attacker in Charlotte, North Carolina. Include details about the shooting, the casualties, and the response from the US Marshals Service
  - Research and list three other prequel films that have been made in the past, including the names of the directors and the films they were directed by. Compare and contrast these films with the original film in terms of plot, animation style, and overall impact.
  - Write a brief summary of the text, highlighting the key points such as the investigation by the National Highway Traffic Safety Administration (NHTSA) and the crash involving Ford's BlueCruise system.
  - Research and compare the features of Ford's BlueCruise driver assistance system with other driver assistance technologies available in the market. Write a short report outlining the differences and similarities between the two systems. Be sure to include information on the impact of the driver monitoring aspect of the system
  - Write a brief summary of the text highlighting the key points about World of Warcraft's 20th birthday and the cancellation of its biggest party.
  - Research and list three other major gaming companies that have been involved in the acquisition of World of Warcraft by Microsoft. Provide a brief description of each company and their involvement in the acquisition.
 
  Finally, here are the 10 tasks genereated by the original model:
  - Write a task that appropriately encompasses the text.
  - Write a task that appropriately encompasses the text.
  - Write a task that appropriately encompasses the text.
  - Write a task that appropriately encompasses the text.
  - Beyoncé and Jay-Z's daughter Blue Ivy Carter has joined the voice cast of The Lion King prequel Mufasa: The Lion King. Blue Ivy, 12, voices Kiara, daughter of King Simba and Queen Nala, played by her mother. Beyoncé is reprising the role from Jon Favreau's 2019 photorealistic remake of the 1994 original. The new film, directed by Moonlight filmmaker Barry Jenkins, will explore Mufasa's origin story and his childhood with
  - Write a task that appropriately encompasses the text.
  - Write a task that appropriately encompasses the text.
  - Write a task that appropriately encompasses the text.
  - World of Warcraft is celebrating its 20th birthday this year, but it's just cancelled its biggest party. Fans of the online game have gathered in Anaheim, California, every year since 2005 for BlizzCon. The convention was a place to meet fellow fans of the series, dress up in your best cosplay and get a first look at what was coming next in the huge fantasy world of Azeroth. But game maker Activision Blizzard has announced it's called off the 2024 edition of the popular event.
  - Write a task that appropriately encompasses the text.

As you can see, the results from this test show that the two models that were finetuned with the dataset are able to understand how to write tasks for the news articles and the original model is not.

## References  
- https://huggingface.co/docs/transformers/en/training
- https://www.datacamp.com/tutorial/fine-tuning-llama-2
- https://huggingface.co/docs/peft/main/en/tutorial/peft_model_config
- https://github.com/brevdev/notebooks/blob/main/llama2-finetune-own-data.ipynb
